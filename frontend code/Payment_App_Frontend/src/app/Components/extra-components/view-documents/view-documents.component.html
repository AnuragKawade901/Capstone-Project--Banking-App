<main class="container-fluid my-4 my-md-5 p-3 p-md-4">

  <nav aria-label="breadcrumb" class="bg-light p-3 rounded-3 mb-4 shadow-sm border">
    <ol class="breadcrumb mb-0">
      <li class="breadcrumb-item">
        <a [routerLink]="
            role === 'CLIENT_USER' ? '/client/home' : 
            role === 'BANK_USER' ? '/bank/home' : 
            '/admin/home'
          ">
          Home
        </a>
      </li>
      <li *ngIf="role === 'BANK_USER' || role === 'ADMIN'" class="breadcrumb-item">
        <a [routerLink]="role === 'BANK_USER' ? '/bank/clients' : '/admin/bankusers'">Clients</a>
      </li>
      <li class="breadcrumb-item active" aria-current="page">View Documents</li>
    </ol>
  </nav>

  <div class="d-flex justify-content-between align-items-center mb-3 pt-3">
    <h2 class="h4 fw-normal mb-0">Client Documents</h2>
  </div>

  <div *ngIf="loading" class="card shadow-sm border-0">
    <div class="card-body text-center p-5">
      <div class="spinner-border text-primary mb-3" role="status" aria-hidden="true"></div>
      <p class="mb-0 text-muted">Loading documents...</p>
    </div>
  </div>

  <div *ngIf="!loading">
    <div *ngIf="documents.length > 0; else noDataFound" class="row g-4">
      <div *ngFor="let doc of documents" class="col-12 col-md-6 col-lg-4">
        <div class="card shadow-sm h-100 border-0">
          <div class="position-relative">
            <img [src]="doc.documentURL" class="card-img-top" alt="{{ doc.documentName }}"
                 style="height:200px; object-fit: cover; cursor:pointer;" (click)="viewDocument(doc)" />
            <span class="badge bg-primary-subtle text-primary-emphasis position-absolute top-0 end-0 m-2">
              Click to View
            </span>
          </div>
          <div class="card-body p-3 d-flex flex-column">
            <h6 class="card-title text-truncate mb-1 fw-bold">{{ doc.documentName }}</h6>
            <p class="mb-1 text-muted small">
              <strong>Proof Type:</strong> {{ doc.proofTypeId }}
            </p>
            <p class="mb-2 text-muted small">
              <strong>Document ID:</strong> {{ doc.documentId }}
            </p>
            <a [href]="doc.documentURL" target="_blank" 
               class="btn btn-sm btn-outline-primary w-100 mt-auto d-flex align-items-center justify-content-center">
              <i class="bi bi-box-arrow-up-right me-1"></i>
              Open in New Tab
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <ng-template #noDataFound>
    <div class="card shadow-sm border-0">
      <div class="card-body text-center p-5">
        <i class="bi bi-info-circle fs-3 d-block mb-2 text-muted"></i>
        <p class="mb-0 text-muted">No documents found for this client.</p>
      </div>
    </div>
  </ng-template>

  <div *ngIf="activeDoc" class="modal fade show d-block" tabindex="-1" style="background: rgba(0,0,0,0.7);">
    <div class="modal-dialog modal-xl modal-dialog-centered">
      <div class="modal-content rounded-3 shadow-lg border-0">
        <div class="modal-header bg-light border-0">
          <h5 class="modal-title fw-bold h6">{{ activeDoc.documentName }}</h5>
          <button type="button" class="btn-close" (click)="activeDoc = null"></button>
        </div>
        <div class="modal-body text-center p-4">
          <img *ngIf="activeDoc.documentURL" [src]="activeDoc.documentURL" class="img-fluid rounded"
               alt="{{ activeDoc.documentName }}" style="max-height: 70vh;" />
          <div class="mt-3 text-start bg-light rounded-3 p-3">
            <p class="mb-1"><strong>Document ID:</strong> {{ activeDoc.documentId }}</p>
            <p class="mb-1"><strong>Proof Type:</strong> {{ activeDoc.proofTypeId }}</p>
            <p class="mb-0"><strong>Public ID:</strong> {{ activeDoc.publicId }}</p>
          </div>
        </div>
        <div class="modal-footer border-0">
          <button type="button" class="btn btn-outline-secondary" (click)="activeDoc = null">Close</button>
          <a [href]="activeDoc.documentURL" target="_blank" 
             class="btn btn-primary d-flex align-items-center">
             <i class="bi bi-box-arrow-up-right me-1"></i>
            Open in new tab
          </a>
        </div>
      </div>
    </div>
  </div>

</main>